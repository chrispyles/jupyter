<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>movies.ipynb</title>
  <meta name="description" content="Movie Genre Predictor">

  <link rel="canonical" href="http://0.0.0.0:4000/notebooks/movies/movies.html">
  <link rel="alternate" type="application/rss+xml" title="Chris Pyles" href="http://0.0.0.0:4000/feed.xml">

  <meta property="og:url"         content="http://0.0.0.0:4000/notebooks/movies/movies.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="movies.ipynb" />
<meta property="og:description" content="Movie Genre Predictor" />
<meta property="og:image"       content="" />


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage":
    "http://0.0.0.0:4000/notebooks/movies/movies.html",
  "headline":
    "movies.ipynb",
  "datePublished":
    "2019-04-18T18:39:31-05:00",
  "dateModified":
    "2019-04-18T18:39:31-05:00",
  "description":
    "Movie Genre Predictor",
  "author": {
    "@type": "Person",
    "name": "Christopher Pyles"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "http://0.0.0.0:4000",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "http://0.0.0.0:4000",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css ">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="https://cpyles.com/assets/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    CommonHTML: {
        linebreaks: {
            automatic: true,
        },
    },
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML' async></script>

  <!-- DOM updating function -->
  <script>
const runWhenDOMLoaded = cb => {
  if (document.readyState != 'loading') {
    cb()
  } else if (document.addEventListener) {
    document.addEventListener('DOMContentLoaded', cb)
  } else {
    document.attachEvent('onreadystatechange', function() {
      if (document.readyState == 'complete') cb()
    })
  }
}

// Helper function to init things quickly
initFunction = function(myfunc) {
  runWhenDOMLoaded(myfunc);
  document.addEventListener('turbolinks:load', myfunc);
};
</script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="/assets/js/anchor.min.js"  type="text/javascript"></script>
  <script>

initFunction(function () {
    anchors.add("main h1, main h2, main h3, main h4")
});

</script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="/assets/js/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  <script src="https://unpkg.com/nbinteract-core" async></script>

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->


  <!-- Google analytics -->
  <script src="/assets/js/ga.js" async></script>

  <!-- Clipboard copy button -->
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" async></script>

  <!-- Load JS that depends on site variables -->
  <script>
/**
 * Set up copy/paste for code blocks
 */
const codeCellId = index => `codecell${index}`

const clipboardButton = id =>
  `<a class="btn copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#${id}">
    <img src="/assets/images/copy-button.svg" alt="Copy to clipboard">
  </a>`

// Clears selected text since ClipboardJS will select the text when copying
const clearSelection = () => {
  if (window.getSelection) {
    window.getSelection().removeAllRanges()
  } else if (document.selection) {
    document.selection.empty()
  }
}

// Changes tooltip text for two seconds, then changes it back
const temporarilyChangeTooltip = (el, newText) => {
  const oldText = el.getAttribute('data-tooltip')
  el.setAttribute('data-tooltip', newText)
  setTimeout(() => el.setAttribute('data-tooltip', oldText), 2000)
}

const addCopyButtonToCodeCells = () => {
  // If ClipboardJS hasn't loaded, wait a bit and try again. This
  // happens because we load ClipboardJS asynchronously.
  if (window.ClipboardJS === undefined) {
    setTimeout(addCopyButtonToCodeCells, 250)
    return
  }

  const codeCells = document.querySelectorAll('div.highlighter-rouge:not(.output) pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    if (document.querySelector(`pre#${id} + a`) == null) {
      codeCell.insertAdjacentHTML('afterend', clipboardButton(id));
    }
  })

  const clipboard = new ClipboardJS('.copybtn')
  clipboard.on('success', event => {
    clearSelection()
    temporarilyChangeTooltip(event.trigger, 'Copied!')
  })

  clipboard.on('error', event => {
    temporarilyChangeTooltip(event.trigger, 'Failed to copy')
  })

  // Get rid of clipboard before the next page visit to avoid memory leak
  document.addEventListener('turbolinks:before-visit', () =>
    clipboard.destroy()
  )
}

initFunction(addCopyButtonToCodeCells);
</script>

  <!-- Hide cell code -->
  
<script>
/**
Add buttons to hide code cells
*/


var setCodeCellVisibility = function(inputField, kind) {
    // Update the image and class for hidden
    var id = inputField.getAttribute('data-id');
    var codeCell = document.querySelector(`#${id}`);

    if (kind === "visible") {
        codeCell.classList.remove('hidden');
        inputField.checked = true;
    } else {
        codeCell.classList.add('hidden');
        inputField.checked = false;
    }
}

var toggleCodeCellVisibility = function (event) {
    // The label is clicked, and now we decide what to do based on the input field's clicked status
    if (event.target.tagName === "LABEL") {
        var inputField = event.target.previousElementSibling;
    } else {
        // It is the span inside the target
        var inputField = event.target.parentElement.previousElementSibling;
    }

    if (inputField.checked === true) {
        setCodeCellVisibility(inputField, "visible");
    } else {
        setCodeCellVisibility(inputField, "hidden");
    }
}


// Button constructor
const hideCodeButton = id => `<input class="hidebtn" type="checkbox" id="hidebtn${id}" data-id="${id}"><label title="Toggle cell" for="hidebtn${id}" class="plusminus"><span class="pm_h"></span><span class="pm_v"></span></label>`

var addHideButton = function () {
  // If a hide button is already added, don't add another
  if (document.querySelector('div.hidecode input') !== null) {
      return;
  }

  // Find the input cells and add a hide button
  document.querySelectorAll('div.input_area div.highlight').forEach(function (item, index) {
    if (!item.parentElement.classList.contains("hidecode")) {
        // Skip the cell if it doesn't have a hidecode class
        return;
    }

    const id = codeCellId(index)
    item.setAttribute('id', id);
    item.insertAdjacentHTML('afterend', hideCodeButton(id))

    // Set up the visibility toggle
    hideLink = document.querySelector(`#${id} + input + label`);
    hideLink.addEventListener('click', toggleCodeCellVisibility)
  });
}


// Initialize the hide buttos
var initHiddenCells = function () {
    // Add hide buttons to the cells
    addHideButton();

    // Toggle the code cells that should be hidden
    document.querySelectorAll('div.hidecode input').forEach(function (item) {
        setCodeCellVisibility(item, 'hidden');
        item.checked = true;
    })
}

initFunction(initHiddenCells);

</script>


  <!-- Load custom website scripts -->
  <script src="/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  

  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="/assets/js/lunr/lunr.min.js" type="text/javascript"></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>
</head>

  <body>
    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  
  <h2 class="c-sidebar__title">Chris Pyles</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/index.html"
        >
          
          Projects and Jupyter Notebooks
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/notebooks/insurance/insurance.html"
                >
                  
                  insurance.ipynb
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/notebooks/avocado/avocado.html"
                >
                  
                  avocado.ipynb
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/notebooks/graduate-admissions/graduate-admissions.html"
                >
                  
                  graduate-admissions.ipynb
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry c-sidebar__entry--active"
                  href="/notebooks/movies/movies.html"
                >
                  
                  movies.ipynb
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
  </ul>
  <p class="sidebar_footer"><a href='https://mybinder.org/v2/gh/chrispyles/jupyter/master?filepath=content%2Fnotebooks' target='_blank'><img src='https://mybinder.org/badge_logo.svg' /></a></p>
</nav>

      
      <!-- Shamelessly copied from minimal mistakes -->


<!-- TOC will only show up if it has at least one item -->


  <aside class="sidebar__right">
    <nav class="onthispage">
      <header><h4 class="nav__title"><i class="fa fa-list"></i>   On this page</h4></header>
      <ul class="toc__menu">
  <li><a href="#the-question">The Question</a></li>
  <li><a href="#data-preprocessing">Data Preprocessing</a></li>
  <li><a href="#grouping-plots--word-recurrence">Grouping Plots &amp; Word Recurrence</a></li>
  <li><a href="#notes">Notes</a></li>
</ul>
    </nav>
  </aside>


      
      <main class="c-textbook__page" tabindex="-1">
          <div class="o-wrapper">
            <div class="c-sidebar-toggle">
  <!-- We show the sidebar by default so we use .is-active -->
  <button
    id="js-sidebar-toggle"
    class="hamburger hamburger--arrowalt is-active"
  >
    <span class="hamburger-box">
      <span class="hamburger-inner"></span>
    </span>
    <span class="c-sidebar-toggle__label">Toggle Sidebar</span>
  </button>
</div>

            
<div class="buttons">




</div>


            <div class="c-textbook__content">
              <h1 id="movie-genre-predictor">Movie Genre Predictor</h1>

<p>In this Jupyter Notebook, I will build a $k$-nearest neighbors classifier that will determine the genre of a movie based on its synopsis. The <a href="https://www.kaggle.com/jrobischon/wikipedia-movie-plots">Wikipedia Movie Plots data set</a> is used in order to generate the training set for the classifier, and I will build my own test set from <a href="https://imdb.com">IMDB</a>. The classifier will work by looking at the frequencies of words in the synposes of movies from each genre.</p>

<ol>
  <li><a href="#question">The Question</a></li>
  <li><a href="#preprocessing">Data Preprocessing</a></li>
  <li><a href="#grouping">Grouping Plots &amp; Word Recurrence</a></li>
</ol>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s">'ggplot'</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s">'ignore'</span><span class="p">,</span> <span class="nb">FutureWarning</span><span class="p">)</span>

<span class="c"># read table</span>
<span class="n">movies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'movie_plots.csv'</span><span class="p">)</span>
<span class="n">movies</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Release Year</th>
      <th>Title</th>
      <th>Origin/Ethnicity</th>
      <th>Director</th>
      <th>Cast</th>
      <th>Genre</th>
      <th>Wiki Page</th>
      <th>Plot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1901</td>
      <td>Kansas Saloon Smashers</td>
      <td>American</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>unknown</td>
      <td>https://en.wikipedia.org/wiki/Kansas_Saloon_Sm...</td>
      <td>A bartender is working at a saloon, serving dr...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1901</td>
      <td>Love by the Light of the Moon</td>
      <td>American</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>unknown</td>
      <td>https://en.wikipedia.org/wiki/Love_by_the_Ligh...</td>
      <td>The moon, painted with a smiling face hangs ov...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1901</td>
      <td>The Martyred Presidents</td>
      <td>American</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>unknown</td>
      <td>https://en.wikipedia.org/wiki/The_Martyred_Pre...</td>
      <td>The film, just over a minute long, is composed...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1901</td>
      <td>Terrible Teddy, the Grizzly King</td>
      <td>American</td>
      <td>Unknown</td>
      <td>NaN</td>
      <td>unknown</td>
      <td>https://en.wikipedia.org/wiki/Terrible_Teddy,_...</td>
      <td>Lasting just 61 seconds and consisting of two ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1902</td>
      <td>Jack and the Beanstalk</td>
      <td>American</td>
      <td>George S. Fleming, Edwin S. Porter</td>
      <td>NaN</td>
      <td>unknown</td>
      <td>https://en.wikipedia.org/wiki/Jack_and_the_Bea...</td>
      <td>The earliest known adaptation of the classic f...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

<div id="question"></div>

<h2 id="the-question">The Question</h2>
<p>The first part of developing a data-driven project is to decide what question you want to answer. The question needs to be specific, and it needs to be something you can develop a step-by-step approach for. With this notebook, I am going to use the <code class="highlighter-rouge">movies</code> DataFrame to answer the following question:</p>
<blockquote>
  <p>Can we predict the genre of a movie based on its plot?</p>
</blockquote>

<p>It will take a few steps to answer this question. The over-arching workflow will look something like this:</p>
<ol>
  <li>Data preprocessing</li>
  <li>Group movies by genre and look for recurring words in plots</li>
  <li>Write a $k$-nearest neighbor classifier</li>
  <li>Test the classifier and determine its accuracy</li>
</ol>

<div id="preprocessing"></div>

<h2 id="data-preprocessing">Data Preprocessing</h2>
<p>Currently, the <code class="highlighter-rouge">movies</code> DataFrame contains details of movies (year, title, country of origin, director, cast, genre, Wiki link, and plot). In order to get meaningful results, the data need to be “cleaned;” that is, we need to edit values that we can’t work with. ince we’re focusing on the genre and plot, we can remove columns with irrelevant information:</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">movies</span> <span class="o">=</span> <span class="n">movies</span><span class="p">[[</span><span class="s">'Genre'</span><span class="p">,</span> <span class="s">'Plot'</span><span class="p">]]</span>
<span class="n">movies</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Genre</th>
      <th>Plot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>unknown</td>
      <td>A bartender is working at a saloon, serving dr...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>unknown</td>
      <td>The moon, painted with a smiling face hangs ov...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>unknown</td>
      <td>The film, just over a minute long, is composed...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>unknown</td>
      <td>Lasting just 61 seconds and consisting of two ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>unknown</td>
      <td>The earliest known adaptation of the classic f...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

<p>The data set, which contains 34,885 entries, has lots of rows that contain <code class="highlighter-rouge">NaN</code> values (“not a number”), which means that we can’t work with them. The <code class="highlighter-rouge">pandas</code> library allows you to remove the rows that contain <code class="highlighter-rouge">NaN</code> values:</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">movies</span> <span class="o">=</span> <span class="n">movies</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">"There are now {movies.shape[0]} rows in the table."</span><span class="p">)</span>
<span class="n">movies</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>There are now 34886 rows in the table.

</code></pre></div></div>

<div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Genre</th>
      <th>Plot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>unknown</td>
      <td>A bartender is working at a saloon, serving dr...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>unknown</td>
      <td>The moon, painted with a smiling face hangs ov...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>unknown</td>
      <td>The film, just over a minute long, is composed...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>unknown</td>
      <td>Lasting just 61 seconds and consisting of two ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>unknown</td>
      <td>The earliest known adaptation of the classic f...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

<p>In the above cell, we also reset the row indices to make slicing the table easier. We now have 34,886 rows, so we lost about 1,400 entries. The next thing to look at is what kinds of values we have in the DataFrame.</p>

<h4 id="data-exploration-and-accptable-genres">Data Exploration and Accptable Genres</h4>
<p>Now we need to see what kinds of data we have in the set. We begin by showing what the values in the <code class="highlighter-rouge">Genre</code> column of the DataFrame are:</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">movies</span><span class="p">[</span><span class="s">'Genre'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</code></pre></div></div>

<div class="output output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array(['unknown', 'western', 'comedy', ...,
       'adventure, romance, fantasy film', 'ero',
       'horror romantic comedy'], dtype=object)
</code></pre></div></div>

<p>It looks like there’s lots of different values in the column (2,210 to be exact). But for this question, we’re really only interested in the basic genres of movies: action, adventure, comedy, drama, fantasy, historical, horror, romance, science fiction, and thriller.</p>

<p>To this end, we will define a function that will read through the <code class="highlighter-rouge">Genre</code> entry in each row and categorize them as one of the above. This process has a few steps:</p>
<ol>
  <li>Define a function that will determine if any of the above words are present in the entry</li>
  <li>Filter <code class="highlighter-rouge">movies</code> for such rows</li>
  <li>Change the entry for <code class="highlighter-rouge">Genre</code> to one of the above for each row left if entry is not one of the above</li>
</ol>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Step 1:</span>
<span class="k">def</span> <span class="nf">contains_acceptable_genre</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
    <span class="n">acceptable_genres</span> <span class="o">=</span> <span class="p">[</span><span class="s">'action'</span><span class="p">,</span> <span class="s">'adventure'</span><span class="p">,</span> <span class="s">'comedy'</span><span class="p">,</span> <span class="s">'drama'</span><span class="p">,</span> <span class="s">'fantasy'</span><span class="p">,</span> <span class="s">'historical'</span><span class="p">,</span> <span class="s">'horror'</span><span class="p">,</span> 
                        <span class="s">'romance'</span><span class="p">,</span> <span class="s">'science fiction'</span><span class="p">,</span> <span class="s">'thriller'</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">genre</span> <span class="ow">in</span> <span class="n">acceptable_genres</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">genre</span> <span class="ow">in</span> <span class="n">entry</span><span class="p">[</span><span class="s">'Genre'</span><span class="p">]:</span>
            <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>

<span class="c"># Step 2:</span>
<span class="n">filtered_movies</span> <span class="o">=</span> <span class="n">movies</span><span class="p">[</span><span class="n">movies</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">contains_acceptable_genre</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">filtered_movies</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Genre</th>
      <th>Plot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>comedy</td>
      <td>The film is about a family who move to the sub...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>short action/crime western</td>
      <td>The film features a train traveling through th...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>comedy</td>
      <td>Before heading out to a baseball game at a nea...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>comedy</td>
      <td>The plot is that of a black woman going to the...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>drama</td>
      <td>On a beautiful summer day a father and mother ...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

<p>In order to accomplish Step 3, we need to develop a few helper functions. Mainly, we need to comb each <code class="highlighter-rouge">Genre</code> entry in <code class="highlighter-rouge">filtered_movies</code> do the following:</p>
<ol>
  <li>Check if it is an exact match for something in <code class="highlighter-rouge">acceptable_genres</code></li>
  <li>If it is not, then use a heuristic to determine which genre it is a part of</li>
  <li>Apply this function to each row of the DataFrame</li>
</ol>

<p>For Step 3.1, we define the function <code class="highlighter-rouge">superfluous_text</code> which returns a Boolean value corresponding to whether or not there are extra characters beyond an entry in <code class="highlighter-rouge">accaptable_genres</code>.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Step 3.1:</span>
<span class="k">def</span> <span class="nf">superfluous_text</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
    <span class="s">"""
    Determines if the string entry is in acceptable_genres
    """</span>
    <span class="n">acceptable_genres</span> <span class="o">=</span> <span class="p">[</span><span class="s">'action'</span><span class="p">,</span> <span class="s">'adventure'</span><span class="p">,</span> <span class="s">'comedy'</span><span class="p">,</span> <span class="s">'drama'</span><span class="p">,</span> <span class="s">'fantasy'</span><span class="p">,</span> <span class="s">'historical'</span><span class="p">,</span> <span class="s">'horror'</span><span class="p">,</span> 
                        <span class="s">'romance'</span><span class="p">,</span> <span class="s">'science fiction'</span><span class="p">,</span> <span class="s">'thriller'</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">genre</span> <span class="ow">in</span> <span class="n">acceptable_genres</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">genre</span> <span class="o">==</span> <span class="n">entry</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">True</span>
</code></pre></div></div>

<p>For Step 3.2, we take entries for which <code class="highlighter-rouge">superfluous_text</code> returns <code class="highlighter-rouge">True</code> and use a heuristic to determine which is the most accurate genre they fall under. The heuristic that we use is that the last word is likely the most general genre (i.e. the noun without any modifiers). In this way, <code class="highlighter-rouge">'historical drama'</code> would become <code class="highlighter-rouge">'drama'</code> and <code class="highlighter-rouge">'action comedy'</code> would become <code class="highlighter-rouge">'comedy'</code>.</p>

<p>The function <code class="highlighter-rouge">determine_genre</code> looks for words starting from the last word and going to the first until it finds an entry in <code class="highlighter-rouge">acceptable_genres</code>. If no such word exists, then an empty string, <code class="highlighter-rouge">''</code>, is inserted instead.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Step 3.2:</span>
<span class="k">def</span> <span class="nf">determine_genre</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
    <span class="s">"""
    Takes a string entry and returns the word closest to the end that is in acceptable_genres
    """</span>
    <span class="n">acceptable_genres</span> <span class="o">=</span> <span class="p">[</span><span class="s">'action'</span><span class="p">,</span> <span class="s">'adventure'</span><span class="p">,</span> <span class="s">'comedy'</span><span class="p">,</span> <span class="s">'drama'</span><span class="p">,</span> <span class="s">'fantasy'</span><span class="p">,</span> <span class="s">'historical'</span><span class="p">,</span> <span class="s">'horror'</span><span class="p">,</span> 
                        <span class="s">'romance'</span><span class="p">,</span> <span class="s">'science fiction'</span><span class="p">,</span> <span class="s">'thriller'</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">superfluous_text</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">entry</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">entry</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span><span class="p">:</span>
            <span class="n">genre</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">genre</span> <span class="o">=</span> <span class="n">genre</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">UnboundLocalError</span><span class="p">:</span>
        <span class="n">genre</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)</span>

    <span class="n">i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">new_genre</span> <span class="o">=</span> <span class="s">''</span>
    <span class="k">while</span> <span class="n">new_genre</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">acceptable_genres</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">new_genre</span> <span class="o">=</span> <span class="n">genre</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">except</span> <span class="nb">IndexError</span><span class="p">:</span>
            <span class="n">new_genre</span> <span class="o">=</span> <span class="s">''</span>
            <span class="k">return</span> <span class="n">new_genre</span>
        <span class="k">if</span> <span class="n">genre</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">acceptable_genres</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">new_genre</span>
</code></pre></div></div>

<p>Finally, for Step 3.3, the function <code class="highlighter-rouge">change_genres</code> takes a DataFrame as its argument and goes through the <code class="highlighter-rouge">Genre</code> column to replace the original <code class="highlighter-rouge">Genre</code> with the result of <code class="highlighter-rouge">determine_genre</code>. Then a new DataFrame is generated by copying the one passed as the argument and dropping the original <code class="highlighter-rouge">Genre</code> column and replacing it with a new <code class="highlighter-rouge">Genre</code> column. Then it filters out rows where the empty string <code class="highlighter-rouge">''</code> was inserted instead of a genre.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Step 3.3:</span>
<span class="k">def</span> <span class="nf">change_genres</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">new_genres</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s">'Genre'</span><span class="p">]:</span>
        <span class="n">new_genre</span> <span class="o">=</span> <span class="n">determine_genre</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
        <span class="n">new_genres</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_genres</span><span class="p">,</span> <span class="n">new_genre</span><span class="p">)</span>
    
    <span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'Genre'</span><span class="p">])</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">Genre</span><span class="o">=</span><span class="n">new_genres</span><span class="p">)</span>
    <span class="n">new_df</span> <span class="o">=</span> <span class="n">new_df</span><span class="p">[</span><span class="n">new_df</span><span class="p">[</span><span class="s">'Genre'</span><span class="p">]</span> <span class="o">!=</span> <span class="s">''</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">new_df</span>

<span class="n">filtered_genres</span> <span class="o">=</span> <span class="n">change_genres</span><span class="p">(</span><span class="n">filtered_movies</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">"The table now has {filtered_genres.shape[0]} rows."</span><span class="p">)</span>
<span class="n">filtered_genres</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The table now has 15852 rows.

</code></pre></div></div>

<div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Plot</th>
      <th>Genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>The film is about a family who move to the sub...</td>
      <td>comedy</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Before heading out to a baseball game at a nea...</td>
      <td>comedy</td>
    </tr>
    <tr>
      <th>2</th>
      <td>The plot is that of a black woman going to the...</td>
      <td>comedy</td>
    </tr>
    <tr>
      <th>3</th>
      <td>On a beautiful summer day a father and mother ...</td>
      <td>drama</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A thug accosts a girl as she leaves her workpl...</td>
      <td>drama</td>
    </tr>
  </tbody>
</table>
</div>
</div>

<h4 id="cleaning-plot-strings">Cleaning Plot Strings</h4>
<p>Now that we have sorted the genres of each movie in the DataFrame, we look now to format the <code class="highlighter-rouge">Plot</code> column so that it can be more easily analyzed. In the cell below, the function <code class="highlighter-rouge">clean_string</code> is defined, which removes all characters that are not letters from a string and makes all letters lowercase. Then the function <code class="highlighter-rouge">words_in_dict</code> is defined which takes in a string and returns a string containing words in the file <a href="#dict">dict.csv</a>. Finally, <code class="highlighter-rouge">clean_plots</code> is defined, which takes a DataFrame as its parameter and goes through each <code class="highlighter-rouge">Plot</code> entry and cleans the string there, returning a new DataFrame with cleaned plot strings.</p>

<p>Because the function <code class="highlighter-rouge">clean_plots</code> takes a while to run on the data set, I ran it once and then exported it as <code class="highlighter-rouge">movies_with_cleaned_plots.csv</code>. The commented out code at the bottom of the cell shows how the function was run and exported. Instead of running it again, we just import the cleaned data using <code class="highlighter-rouge">pd.read_csv()</code>.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dictionary</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'dict.csv'</span><span class="p">)[</span><span class="s">'dictionary'</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">clean_string</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="s">' '</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            
    <span class="k">return</span> <span class="n">s</span>

<span class="k">def</span> <span class="nf">words_in_dict</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)</span>
    
    <span class="n">words_to_delete</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">:</span>
            <span class="n">words_to_delete</span> <span class="o">+=</span> <span class="p">[</span><span class="n">word</span><span class="p">]</span>
            
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words_to_delete</span><span class="p">:</span>
        <span class="n">s</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="s">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">clean_plots</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">plots</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'Plot'</span><span class="p">])</span>
    
    <span class="n">cleaned_plots</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">plot</span> <span class="ow">in</span> <span class="n">plots</span><span class="p">:</span>
        <span class="n">cleaned_plot</span> <span class="o">=</span> <span class="n">clean_string</span><span class="p">(</span><span class="n">plot</span><span class="p">)</span>
        <span class="n">cleaned_plot</span> <span class="o">=</span> <span class="n">words_in_dict</span><span class="p">(</span><span class="n">cleaned_plot</span><span class="p">)</span>
        <span class="n">cleaned_plots</span> <span class="o">+=</span> <span class="p">[</span><span class="n">cleaned_plot</span><span class="p">]</span>
        
    <span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'Plot'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">Plot</span><span class="o">=</span><span class="n">cleaned_plots</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_df</span>

<span class="c"># # Commented out below lines to save time when running this code later:</span>
<span class="c"># movies_with_cleaned_plots = clean_plots(filtered_genres)</span>
<span class="c"># movies_with_cleaned_plots.to_csv('movies_with_cleaned_plots.csv', index=False)</span>

<span class="c"># Importing the csv with the data that would have been created by running the code above:</span>
<span class="n">movies_with_cleaned_plots</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'movies_with_cleaned_plots.csv'</span><span class="p">)</span>
<span class="n">movies_with_cleaned_plots</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Genre</th>
      <th>Plot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>comedy</td>
      <td>film about a family hoping for a life go leadi...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>comedy</td>
      <td>heading a game a fan he watch game has game hi...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>comedy</td>
      <td>a going for a given laughing gas her walking h...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>drama</td>
      <td>a a father take river a wares gypsy rob father...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>drama</td>
      <td>a a girl leaves her a her revenge help girl he...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

<div id="grouping"></div>

<h2 id="grouping-plots--word-recurrence">Grouping Plots &amp; Word Recurrence</h2>
<p>Before going on, I think it’s a good idea to see how prevalent the different genres are in our classifier. To that end, I will plot a histogram of this data using matplotlib.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">genre_counts</span> <span class="o">=</span> <span class="n">movies_with_cleaned_plots</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'Genre'</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">genre_counts</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">genre_counts</span><span class="p">[</span><span class="s">'Plot'</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Histogram of Genres in movies_with_cleaned_genres'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Genre'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Count'</span><span class="p">);</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../images/notebooks/movies/movies_21_0.png" alt="png" /></p>

<p>Obviously, there is a wide variance of the frequency of each genre. This will likely affect the accuracy of the classifier, but we will test that in the last section of this notebook.</p>

<p>Now we can begin look at recurrent words within genres. To begin, we group the <code class="highlighter-rouge">movies_with_cleaned_plots</code> table by genre and aggregate the <code class="highlighter-rouge">Plot</code> column into lists.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot_lists</span> <span class="o">=</span> <span class="n">movies_with_cleaned_plots</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'Genre'</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="n">plot_lists</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Plot</th>
    </tr>
    <tr>
      <th>Genre</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>action</th>
      <td>[in world war i american pilots mal andrews ch...</td>
    </tr>
    <tr>
      <th>adventure</th>
      <td>[a white girl florence lawrence rejects a prop...</td>
    </tr>
    <tr>
      <th>comedy</th>
      <td>[before heading out to a baseball game at a ne...</td>
    </tr>
    <tr>
      <th>drama</th>
      <td>[on a beautiful summer day a father and mother...</td>
    </tr>
    <tr>
      <th>fantasy</th>
      <td>[the daughter of king neptune takes on human f...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">words_by_genre</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">genre</span> <span class="ow">in</span> <span class="n">plot_lists</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
    <span class="n">plots</span> <span class="o">=</span> <span class="n">plot_lists</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">genre</span><span class="p">,]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">word_counts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">plot</span> <span class="ow">in</span> <span class="n">plots</span><span class="p">:</span>
        <span class="n">plot</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">plot</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">word_counts</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">except</span> <span class="nb">KeyError</span><span class="p">:</span>
                <span class="n">word_counts</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">words_by_genre</span><span class="p">[</span><span class="n">genre</span><span class="p">]</span> <span class="o">=</span> <span class="n">word_counts</span>
</code></pre></div></div>

<h2 id="notes">Notes</h2>

<div id="dict"></div>

<p><code class="highlighter-rouge">dict.csv</code>: This CSV file contains (almost) all the words in the English language, transformed to lowercase and with any punctuation removed. The file is from <a href="https://github.com/manassharma07/English-Dictionary-CSV">this Github repo</a>, and it exists in its original format in the file <a href="./dictionary.csv">dictionary.csv</a>. To see the code that I used to transform the dictionary to lower case and remove punctuation, see <a href="./editing_dictionary">editing_dictionary.ipynb</a>.</p>

              <nav class="c-page__nav">
  
    
    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/notebooks/graduate-admissions/graduate-admissions">
      〈 <span class="u-margin-right-tiny"></span> graduate-admissions.ipynb
    </a>
  

  
    
    <a id="js-page__nav__next" class="c-page__nav__next" href="">
       <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

            </div>
          </div>
        </div>
      </main>
    </div>

  </body>
</html>
